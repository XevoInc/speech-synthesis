/*!
 * speech-synthesis v0.2.1
 * The MIT License
 * Copyright (c) 2014 Jan Antala <hello@janantala.com>
 */

!function(n,e){"use strict";var i=function(n){this.isPolyfill=!0,this.text=n||"",this.lang=e.documentElement.lang||"en-US",this.volume=1,this.rate=1,this.voiceURI="native",this.pitch=1,this.onstart=void 0,this.onend=void 0,this.onerror=void 0,this.onpause=void 0,this.onresume=void 0,this.onmark=void 0,this.onboundary=void 0,this.corsProxyServer="http://www.corsproxy.com/";var i,t,o=this,s={charIndex:void 0,elapsedTime:void 0,name:void 0},a=function(){t=(new Date).getTime(),s.elapsedTime=(t-(i||t))/1e3};return this._initAudio=function(){var n=new Audio;n.addEventListener("play",function(){a(),i?o.onresume&&o.onresume(s):(i=(new Date).getTime(),o.onstart&&o.onstart(s))},!1),n.addEventListener("ended",function(){a(),o.onend&&o.onend(s)},!1),n.addEventListener("error",function(){a(),o.onerror&&o.onerror(s)},!1),n.addEventListener("pause",function(){n.ended||(a(),o.onpause&&o.onpause(s))},!1);var e=[o.corsProxyServer,"translate.google.com/translate_tts?ie=UTF-8&q=",o.text,"&tl=",o.lang].join("");return n.src=e,n.volume=o.volume,n.playbackRate=o.rate,n},this},t=function(){this.isPolyfill=!0,this.pending=!1,this.speaking=!1,this.paused=!1;var n=this,e=new Audio,i=[],t=function(i){var t=i.shift();n.speaking=!1,n.pending=i.length?!0:!1,t&&(e=t._initAudio(),o(e),d())},o=function(n){n.addEventListener("play",function(){},!1),n.addEventListener("ended",function(){t(i)},!1),n.addEventListener("error",function(){t(i)},!1),n.addEventListener("pause",function(){},!1)},s=function(e){n.pending=!0,i.push(e),n.speaking||n.paused||t(i)},a=function(){e.src="",e=void 0,e=new Audio,n.pending=!1,n.speaking=!1,n.paused=!1,i=[],t(i)},r=function(){e.pause(),n.speaking=!1,n.paused=!0},d=function(){e.src?(e.play(),n.speaking=!0):t(i),n.paused=!1},u=function(){return[]};return{isPolyfill:!0,pending:n.pending,speaking:n.speaking,paused:n.paused,speak:function(n){s(n)},cancel:function(){a()},pause:function(){r()},resume:function(){d()},getVoices:function(){u()}}};n.SpeechSynthesisUtterancePolyfill=i,n.speechSynthesisPolyfill=new t}(window,document);