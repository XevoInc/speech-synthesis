/*!
 * speech-synthesis v0.1.0
 * The MIT License
 * Copyright (c) 2014 Jan Antala <hello@janantala.com>
 */

!function(e,n){"use strict";var t=function(e){this.text=e||"",this.lang=n.documentElement.lang||"en-US",this.volume=1,this.rate=1,this.voiceURI="native",this.pitch=1,this.onstart=void 0,this.onend=void 0,this.onerror=void 0,this.onpause=void 0,this.onresume=void 0,this.onmark=void 0,this.onboundary=void 0,this.corsProxyServer="http://www.corsproxy.com/";var t,i,o=this,s={charIndex:void 0,elapsedTime:void 0,name:void 0},r=function(){i=(new Date).getTime(),s.elapsedTime=(i-(t||i))/1e3};return this._initAudio=function(){var e=new Audio;e.addEventListener("play",function(){r(),t?o.onresume&&o.onresume(s):(t=(new Date).getTime(),o.onstart&&o.onstart(s))},!1),e.addEventListener("ended",function(){r(),o.onend&&o.onend(s)},!1),e.addEventListener("error",function(){r(),o.onerror&&o.onerror(s)},!1),e.addEventListener("pause",function(){e.ended||(r(),o.onpause&&o.onpause(s))},!1);var n=[o.corsProxyServer,"translate.google.com/translate_tts?ie=UTF-8&q=",o.text,"&tl=",o.lang].join("");return e.src=n,e.volume=o.volume,e.playbackRate=o.rate,e},this},i=function(){this.pending=!1,this.speaking=!1,this.paused=!1;var e=this,n=new Audio,t=[],i=function(t){var i=t.shift();e.speaking=!1,e.pending=t.length?!0:!1,i&&(n=i._initAudio(),o(n),u())},o=function(e){e.addEventListener("play",function(){},!1),e.addEventListener("ended",function(){i(t)},!1),e.addEventListener("error",function(){i(t)},!1),e.addEventListener("pause",function(){},!1)},s=function(n){e.pending=!0,t.push(n),e.speaking||e.paused||i(t)},r=function(){n.src="",n=void 0,n=new Audio,e.pending=!1,e.speaking=!1,e.paused=!1,t=[],i(t)},a=function(){n.pause(),e.speaking=!1,e.paused=!0},u=function(){n.src?(n.play(),e.speaking=!0):i(t),e.paused=!1},d=function(){return[]};return{speak:function(e){s(e)},cancel:function(){r()},pause:function(){a()},resume:function(){u()},getVoices:function(){d()}}};e.SpeechSynthesisUtterance=e.SpeechSynthesisUtterance||t,e.speechSynthesis=e.speechSynthesis||new i}(window,document);